这是一道经典的迷宫问题。

迷宫中有起点、终点、空地（可走）、障碍物（不可走）以及若干传送点。

从起点开始，到终点结束，每一时刻只能向上、下、左、右四个方向走一步，走一步消耗一单位时间；任意两个传送点之间可以互相传送，且不消耗时间。

你的目标是计算出从起点走到终点的最短时间。

输入：

第一行包含两个数字n,m（1<=n,m<=2000）

接下来包含n行，每行m个字符，表示现在的地图。'.'表示空地，'M’表示障碍物，’E’表示传送点，'N'表示起点，'C'表示终点。'N'和’C'在地图中出现且仅出现一次。

输出：

一个数字，表示从起点走到终点的最短时间。如果永远走不到，输出“No Way”。

Sample Input

6 6

...E..

EMM.M.

.M..M.

.MC.M.

.MMM..

N..E..

Sample Output

7
